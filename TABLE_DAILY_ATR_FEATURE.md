# 批量策略表格新增日线ATR列功能

## 功能概述

已成功在批量策略结果表格中新增"日线ATR"列，现在用户可以在同一个表格中查看所有ATR数据进行对比分析。

## 表格列结构更新

### 更新前的表格列
```
币种 | 策略类型 | 谢林点 | 当前价格 | 建议杠杆 | 入场价格 | 止盈百分比 | 15分钟ATR | 4小时ATR | 风险等级
```

### 更新后的表格列
```
币种 | 策略类型 | 谢林点 | 当前价格 | 建议杠杆 | 入场价格 | 止盈百分比 | 15分钟ATR | 4小时ATR | 日线ATR | 风险等级
```

## 新增功能特点

### 1. **日线ATR列显示**
- ✅ 显示日线ATR当前值（6位小数精度）
- ✅ 显示日线ATR最大值（如果大于当前值）
- ✅ 橙色标识最大值，便于识别保守计算数据
- ✅ 数据不可用时显示"N/A"

### 2. **数据格式化**
```typescript
{
  title: '日线ATR',
  key: 'atr1d',
  render: (_: any, record: StrategyOutput) => {
    const atr1d = record.atr1d;
    const atr1dMax = record.atr1dMax;
    if (atr1d) {
      return (
        <div>
          <div style={{ fontSize: '13px', fontWeight: 'bold' }}>
            {atr1d.toFixed(6)}
          </div>
          {atr1dMax && atr1dMax > atr1d && (
            <div style={{ fontSize: '11px', color: '#fa8c16' }}>
              最大: {atr1dMax.toFixed(6)}
            </div>
          )}
        </div>
      );
    }
    return 'N/A';
  }
}
```

### 3. **表格优化**
- ✅ 调整表格滚动宽度：从1200px增加到1350px
- ✅ 支持按日线ATR值排序
- ✅ 保持与其他ATR列一致的显示风格

## 用户界面展示

### 表格示例
```
┌──────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│ 币种 │策略类型│ 谢林点 │当前价格│建议杠杆│入场价格│止盈百分│15分钟  │4小时   │日线    │风险等级│
│      │        │        │        │        │        │比      │ATR     │ATR     │ATR     │        │
├──────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ BTC  │ 兜底区 │ 95000  │ 100000 │[4h▼]   │ 95000  │ 5.26%  │0.500000│2.000000│5.000000│ 低风险 │
│      │        │        │        │  40x   │        │        │        │最大:   │最大:   │        │
│      │        │        │        │        │        │        │        │2.500000│6.000000│        │
├──────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ETH  │ 探顶区 │ 3500   │ 3600   │[1d▼]   │ 3500   │ 2.86%  │0.080000│0.150000│0.300000│ 中风险 │
│      │        │        │        │  12x(1d)│       │        │        │最大:   │最大:   │        │
│      │        │        │        │        │        │        │        │0.180000│0.360000│        │
└──────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘
```

## 数据对比分析优势

### 1. **ATR数据全景视图**
用户现在可以在同一行中看到：
- **15分钟ATR**：短期波动性指标
- **4小时ATR**：中期波动性指标  
- **日线ATR**：长期波动性指标

### 2. **杠杆计算透明化**
- 用户可以直观看到不同ATR类型的数值差异
- 理解为什么日线ATR会产生更保守的杠杆
- 便于做出明智的ATR类型选择

### 3. **风险评估增强**
- 通过对比不同时间周期的ATR，更好地评估币种的波动性
- 日线ATR通常更大，反映长期波动风险
- 帮助用户选择合适的持仓周期

## 技术实现细节

### 1. **数据来源**
- 日线ATR数据来自后端API：`/api/contracts/{symbol}/atr`
- 包含`atr1d`和`atr1d_max`字段
- 与4小时ATR和15分钟ATR使用相同的数据结构

### 2. **显示逻辑**
```typescript
// 显示当前值
{atr1d.toFixed(6)}

// 显示最大值（如果存在且大于当前值）
{atr1dMax && atr1dMax > atr1d && (
  <div style={{ fontSize: '11px', color: '#fa8c16' }}>
    最大: {atr1dMax.toFixed(6)}
  </div>
)}
```

### 3. **排序功能**
```typescript
sorter: (a: StrategyOutput, b: StrategyOutput) => {
  const aA = a.atr1d || 0;
  const bA = b.atr1d || 0;
  return aA - bA;
}
```

## 用户体验改进

### 1. **信息密度优化**
- 在有限的表格空间中展示更多有价值的信息
- 保持表格的可读性和美观性
- 支持横向滚动查看完整信息

### 2. **数据一致性**
- 所有ATR列使用相同的显示格式
- 统一的数值精度（6位小数）
- 一致的最大值标识样式

### 3. **决策支持**
- 用户可以快速对比不同时间周期的ATR
- 更容易理解杠杆计算的依据
- 支持更精准的风险管理决策

## 测试建议

### 1. **数据完整性测试**
- 验证日线ATR数据正确显示
- 检查最大值标识是否正确
- 确认数据不可用时显示"N/A"

### 2. **界面响应性测试**
- 测试表格在不同屏幕尺寸下的显示
- 验证横向滚动功能正常
- 检查列宽度是否合适

### 3. **排序功能测试**
- 测试按日线ATR排序功能
- 验证排序结果的正确性
- 检查与其他列排序的一致性

现在批量策略表格已经包含了完整的ATR数据展示，用户可以更全面地分析和比较不同币种的波动性特征！
